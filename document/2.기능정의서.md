## 개요

* 요구사항 명세서를 기반으로 수의사 온라인 상담 플랫폼이 제공해야 할 기능을 업무 흐름과 시나리오 중심으로 정의한다.

## 전체 기능 흐름

1. 보호자 회원가입 및 로그인
2. 반려동물 프로필 등록
3. 수의사 검색 및 정보 조회
4. 상담 요청 생성
5. 수의사 매칭 및 알림
6. 실시간 상담 진행
7. 상담 종료 및 리포트 작성
8. 상담 이력 조회

---

## 보호자(User) 기능 정의

### 1 회원가입 및 로그인

* 보호자는 이메일/비밀번호 기반으로 회원가입할 수 있다.
* 인증 성공 시 로그인 상태를 유지할 수 있다.

### 2 반려동물 프로필 관리

* 보호자는 반려동물 정보를 등록할 수 있다.
* 등록된 반려동물 정보는 수정 및 삭제가 가능하다.

### 3 수의사 검색 및 조회

* 보호자는 상담 가능한 수의사 목록을 조회할 수 있다.
* 수의사 목록은 카테고리 또는 전문 분야 기준으로 필터링할 수 있다.
* 보호자는 수의사의 기본 정보(이름, 전문 분야)를 조회할 수 있다.

### 4 상담 요청

* 보호자는 반려동물을 선택한 후 증상 및 상담 카테고리를 입력한다.
* 상담 요청 시 시스템은 상담 요청 상태를 생성한다.

### 5 실시간 상담

* 상담이 매칭되면 보호자는 실시간 채팅 상담에 참여할 수 있다.
* 상담 중 메시지는 실시간으로 전달된다.

### 6 상담 종료

* 보호자는 상담 종료를 요청할 수 있다.
* 상담 종료 요청 시 상담 상태는 종료 대기 상태로 변경된다.

### 7 상담 이력 조회

* 보호자는 종료된 상담 목록을 조회할 수 있다.
* 각 상담별 상담 정보를 확인할 수 있다.

---

## 수의사(Vet) 기능 정의

### 1 수의사 등록 및 인증

* 수의사는 자격 정보를 입력하여 등록 요청을 할 수 있다.
* 관리자의 승인 이후 상담이 가능하다.

### 2 상담 요청 수신

* 수의사는 매칭된 상담 요청 알림을 수신한다.
* 수의사는 상담 요청 내용을 확인할 수 있다.

### 3 실시간 상담

* 수의사는 보호자와 실시간 채팅 상담을 진행한다.
* 상담 중 메시지는 기록된다.

### 4 상담 종료 및 리포트 작성

* 수의사는 상담을 종료 처리할 수 있다.
* 상담 종료 후 상담 리포트를 작성한다.
* 작성된 리포트는 보호자에게 제공된다.

---

## 관리자(Admin) 기능 정의

### 1 수의사 승인 관리

* 관리자는 수의사 등록 요청 목록을 조회한다.
* 수의사 자격 정보를 검증 후 승인 또는 반려 처리한다.

### 2 상담 카테고리 및 태그 관리

* 관리자는 상담 카테고리를 등록, 수정, 삭제할 수 있다.
* 카테고리는 상담 요청 시 선택 항목으로 제공된다.

---

## 상담 상태 정의

| 상태 | 설명 |
|------|------|
| REQUESTED | 보호자가 상담을 요청한 상태 |
| MATCHED | 상담 가능한 수의사가 매칭된 상태 |
| IN_PROGRESS | 보호자와 수의사가 상담을 진행 중인 상태 |
| CLOSING | 보호자 또는 수의사가 상담 종료를 요청한 상태 |
| CLOSED | 상담이 정상적으로 종료된 상태 |
| CANCELLED | 매칭 실패 또는 사용자/시스템에 의해 상담이 취소된 상태 |


---

## 예외 처리

- 매칭 가능한 수의사가 없는 경우 상담 요청은 일정 시간 동안 대기 상태로 유지된다.
- 일정 시간 동안 매칭이 이루어지지 않을 경우 상담 요청은 CANCELLED 상태로 변경된다.
- 수의사가 상담 요청을 수락하지 않거나 응답하지 않는 경우, 상담 요청은 재매칭되거나 CANCELLED 처리될 수 있다.
- 상담 진행 중 비정상 종료가 발생한 경우, 상담 상태는 시스템 정책에 따라 종료 또는 취소 처리된다.

